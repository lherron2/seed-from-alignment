\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage{pgfplots}
\usepgfplotslibrary{groupplots}
\pgfplotsset{compat=1.18}

\title{FR3D/BGSU under400 Baseline Comparison}
\date{}

\begin{document}
\maketitle

\section*{Scope}
This report compares the current pipeline against three single-sequence baselines on the FR3D/BGSU representative non-rRNA set (\textbf{under 400 nt}).
Metrics focus on \textbf{top-1} (F1@1) and \textbf{best-of-100} (F1@100).

\section*{Methods (high level)}
\begin{itemize}
  \item \textbf{RNAnneal-ss (pipeline)}: existing CaCoFold + refinement + MCMC pipeline outputting 100 candidates.
  \item \textbf{RNAstructure}: \texttt{Fold} MFE structure (padded to 100 for consistent @100 evaluation).
  \item \textbf{LinearFold}: LinearFold-V with \texttt{--zuker} suboptimal enumeration (first 100 structures used).
  \item \textbf{EternaFold}: MEA prediction plus additional structures from \texttt{contrafold sample} to reach 100 total candidates.
\end{itemize}

\section*{Results}
\input{generated/overall_table.tex}
\input{generated/length_table.tex}

\section*{Empirical CDFs}
\begin{figure}[ht]
\centering
\begin{tikzpicture}
\begin{groupplot}[
  group style={group size=2 by 1, horizontal sep=1.2cm},
  width=0.48\textwidth,
  height=0.42\textwidth,
  xmin=0, xmax=1,
  ymin=0, ymax=1,
  grid=both,
  xlabel={F1},
  ylabel={CDF},
]
\nextgroupplot[title={Top-1 (F1@1)}, legend columns=2, legend style={at={(0.5,-0.25)},anchor=north}]
\addplot+[const plot, thick] table [x=f1, y=cdf] {generated/cdf_top1_pipeline.dat};
\addlegendentry{RNAnneal-ss}
\addplot+[const plot, thick] table [x=f1, y=cdf] {generated/cdf_top1_rnastructure.dat};
\addlegendentry{RNAstructure}
\addplot+[const plot, thick] table [x=f1, y=cdf] {generated/cdf_top1_linearfold.dat};
\addlegendentry{LinearFold-V}
\addplot+[const plot, thick] table [x=f1, y=cdf] {generated/cdf_top1_eternafold.dat};
\addlegendentry{EternaFold}

\nextgroupplot[title={Best-of-100 (F1@100)}, ylabel={}]
\addplot+[const plot, thick, forget plot] table [x=f1, y=cdf] {generated/cdf_best100_pipeline.dat};
\addplot+[const plot, thick, forget plot] table [x=f1, y=cdf] {generated/cdf_best100_rnastructure.dat};
\addplot+[const plot, thick, forget plot] table [x=f1, y=cdf] {generated/cdf_best100_linearfold.dat};
\addplot+[const plot, thick, forget plot] table [x=f1, y=cdf] {generated/cdf_best100_eternafold.dat};
\end{groupplot}
\end{tikzpicture}
\caption{Empirical CDFs of per-target F1. Curves that shift right indicate higher accuracy.}
\end{figure}

\end{document}
